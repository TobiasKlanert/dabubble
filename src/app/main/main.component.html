<div class="main-wrapper flex-center">
  <div class="main-content flex-center flex-column">
    <header class="main-header">
      <div class="left-column">
        <img
          class="logo"
          src="./assets/img/logo-with-text.svg"
          alt="DABubble Logo"
        />
      </div>
      <div class="center-column">
        <form
          (submit)="onSearch(searchInput.value, searchInput, $event)"
          class="search-form"
        >
          <input
            #searchInput
            name="searchInput"
            type="text"
            class="search-input"
            placeholder="Devspace durchsuchen"
            autocomplete="off"
            (input)="onSearch(searchInput.value)"
          />
          <span class="tooltip">Suche mit &commat; nach Usern und mit # nach Channels</span>
          <button
            type="button"
            class="search-button"
            (click)="onSearch(searchInput.value, searchInput)"
            aria-label="Suche starten"
          >
            <img src="./assets/img/search-grey.svg" alt="Suche" />
          </button>
          @if (!isSearchMenuHidden && searchResults.length > 0) {
          <app-search-menu
            class="search-menu"
            (clickOutside)="searchResults = []; searchInput.value = ''"
            (isSearchMenuHidden)="onSearchMenuHidden($event, searchInput)"
            [searchResults]="searchResults"
            [currentSearchType]="currentSearchType"
          >
          </app-search-menu>
          }
        </form>
      </div>
      <div class="right-column">
        <button class="profile-button" *ngIf="user" (click)="openProfileMenu()">
          <p>{{ user.name }}</p>
          <div class="profile-picture-container">
            <img
              class="profile-picture"
              src="{{ user.profilePictureUrl }}"
              alt="Profilbild"
            />
            <span class="online-marker"></span>
          </div>
          <svg
            width="30"
            height="30"
            viewBox="0 0 30 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <mask
              id="mask0_235_460"
              style="mask-type: alpha"
              maskUnits="userSpaceOnUse"
              x="0"
              y="0"
              width="30"
              height="30"
            >
              <rect width="30" height="30" fill="#D9D9D9" />
            </mask>
            <g mask="url(#mask0_235_460)">
              <path
                d="M15 19.1875C14.8333 19.1875 14.6721 19.1562 14.5162 19.0937C14.3596 19.0312 14.2292 18.9479 14.125 18.8437L8.375 13.0938C8.14583 12.8646 8.03125 12.5729 8.03125 12.2187C8.03125 11.8646 8.14583 11.5729 8.375 11.3437C8.60417 11.1146 8.89583 11 9.25 11C9.60417 11 9.89583 11.1146 10.125 11.3437L15 16.2188L19.875 11.3437C20.1042 11.1146 20.3958 11 20.75 11C21.1042 11 21.3958 11.1146 21.625 11.3437C21.8542 11.5729 21.9688 11.8646 21.9688 12.2187C21.9688 12.5729 21.8542 12.8646 21.625 13.0938L15.875 18.8437C15.75 18.9687 15.6146 19.0571 15.4688 19.1087C15.3229 19.1612 15.1667 19.1875 15 19.1875Z"
                fill="black"
              />
            </g>
          </svg>
        </button>
      </div>
    </header>
    <main class="main-main">
      @if (!isWorkspaceHidden) {
      <aside class="devspace">
        <app-devspace></app-devspace>
      </aside>
      }
      <button class="btn-toggle-workspace" (click)="toggleWorkspaceMenu()">
        @if (!isWorkspaceHidden) {
        <svg
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <rect
            x="8"
            y="8"
            width="16"
            height="16"
            rx="1"
            stroke="black"
            stroke-width="2"
          />
          <path d="M13.7142 8V24" stroke="black" stroke-width="2" />
          <path
            d="M19.4285 18.2856L17.4964 16.3535C17.3011 16.1582 17.3011 15.8416 17.4964 15.6464L19.4285 13.7142"
            stroke="black"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
        <span>Workspace-Menü schließen</span>
        } @if (isWorkspaceHidden) {
        <svg
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <rect
            x="8"
            y="8"
            width="16"
            height="16"
            rx="1"
            stroke="black"
            stroke-width="2"
          />
          <path d="M13.7144 8V24" stroke="black" stroke-width="2" />
          <path
            d="M17.143 18.2856L19.0752 16.3535C19.2704 16.1582 19.2704 15.8416 19.0752 15.6464L17.143 13.7142"
            stroke="black"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
        <span>Workspace-Menu öffnen</span>
        }
      </button>
      <section
        class="chat"
        [ngStyle]="{ width: isWorkspaceHidden ? '73%' : '52%' }"
      >
        <app-chat></app-chat>
      </section>
      <aside class="threads" *ngIf="isThreadsHidden">
        <app-threads></app-threads>
      </aside>
      <app-overlay></app-overlay>
    </main>
  </div>
</div>
